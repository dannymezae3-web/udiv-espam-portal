<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reportes y Estadísticas - UDIV ESPAM MFL</title>
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Fuente Work Sans según manual de identidad -->
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100;0,300;0,400;0,600;0,700;0,900;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.css">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <style>
        /* PALETA CROMÁTICA ESPAM MFL */
        :root {
            --espam-primary: #005846;      /* Verde principal */
            --espam-secondary: #39b54a;    /* Verde secundario claro */
            --espam-accent: #cbdb2a;       /* Verde amarillo */
            --espam-teal: #08b89d;         /* Verde aguamarina */
            --espam-light: #F8F8F2;        /* Fondo claro */
            --espam-white: #FFFFFF;
            --espam-dark: #1a1a1a;
            --espam-gray: #666666;
            --espam-light-gray: #e0e0e0;
        }

        /* FUENTES ESPAM */
        body {
            font-family: 'Work Sans', sans-serif;
            color: var(--espam-dark);
            line-height: 1.6;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Work Sans', sans-serif;
            font-weight: 700;
        }

        /* Estilos específicos para reportes */
        .reports-header {
            background: linear-gradient(135deg, var(--espam-primary) 0%, #004035 100%);
            color: var(--espam-white);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 88, 70, 0.2);
        }

        .reports-header h1 {
            margin-bottom: 10px;
            font-size: 1.8rem;
            color: var(--espam-white);
        }

        .reports-controls {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .date-range {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.1);
            padding: 10px 15px;
            border-radius: 5px;
            color: var(--espam-white);
        }

        .date-range input {
            padding: 8px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 4px;
            background: rgba(255,255,255,0.9);
            font-family: 'Work Sans', sans-serif;
        }

        .btn-generate {
            background-color: var(--espam-secondary);
            color: var(--espam-white);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            font-family: 'Work Sans', sans-serif;
            transition: all 0.3s;
        }

        .btn-generate:hover {
            background-color: var(--espam-teal);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(8, 184, 157, 0.3);
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .report-card {
            background: var(--espam-white);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid var(--espam-light-gray);
        }

        .report-card h3 {
            color: var(--espam-primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--espam-light-gray);
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 700;
        }

        .report-card h3 i {
            color: var(--espam-secondary);
        }

        .chart-container {
            position: relative;
            height: 250px;
            margin-top: 20px;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-summary-item {
            text-align: center;
            padding: 15px;
            background: var(--espam-light);
            border-radius: 8px;
            border: 1px solid var(--espam-light-gray);
        }

        .stat-summary-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--espam-primary);
            margin-bottom: 5px;
        }

        .stat-summary-label {
            font-size: 0.9rem;
            color: var(--espam-gray);
            font-weight: 500;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.9rem;
        }

        .report-table th {
            background-color: var(--espam-primary);
            color: var(--espam-white);
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .report-table td {
            padding: 10px;
            border-bottom: 1px solid var(--espam-light-gray);
        }

        .report-table tr:hover {
            background-color: var(--espam-light);
        }

        .export-options {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: flex-end;
        }

        .btn-export {
            padding: 8px 15px;
            border: 1px solid var(--espam-secondary);
            background: var(--espam-white);
            color: var(--espam-secondary);
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            font-family: 'Work Sans', sans-serif;
            font-weight: 600;
        }

        .btn-export:hover {
            background-color: var(--espam-secondary);
            color: var(--espam-white);
            transform: translateY(-2px);
        }

        .filters-section {
            background: var(--espam-white);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid var(--espam-light-gray);
        }

        .filters-section h3 {
            color: var(--espam-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
        }

        .filters-section h3 i {
            color: var(--espam-secondary);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--espam-primary);
            font-family: 'Work Sans', sans-serif;
        }

        .filter-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--espam-light-gray);
            border-radius: 5px;
            font-family: 'Work Sans', sans-serif;
            transition: border-color 0.3s;
        }

        .filter-group select:focus {
            outline: none;
            border-color: var(--espam-secondary);
            box-shadow: 0 0 0 3px rgba(57, 181, 74, 0.1);
        }

        /* Estados en tablas */
        .status-optimo {
            color: var(--espam-secondary);
            font-weight: 600;
        }

        .status-mantenimiento {
            color: #dc3545;
            font-weight: 600;
        }

        .status-regular {
            color: #ffc107;
            font-weight: 600;
        }

        /* Elementos de lista */
        ul {
            list-style: none;
            padding: 0;
        }

        ul li {
            padding: 5px 0;
            color: var(--espam-gray);
        }

        ul li:before {
            content: "•";
            color: var(--espam-secondary);
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }

        /* Sección de recomendaciones */
        .recomendaciones {
            margin-top: 25px;
            padding: 15px;
            background-color: var(--espam-light);
            border-radius: 8px;
            border-left: 4px solid var(--espam-accent);
        }

        .recomendaciones h5 {
            color: var(--espam-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recomendaciones h5 i {
            color: var(--espam-accent);
        }

        /* Grid para reporte unificado */
        .grid-2-columns {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .reports-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 200px;
            }
            
            .reports-controls {
                flex-direction: column;
            }
            
            .date-range {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .btn-generate {
                width: 100%;
                justify-content: center;
            }
            
            .export-options {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .grid-2-columns {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .report-card {
                padding: 15px;
            }
            
            .stats-summary {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .report-table {
                font-size: 0.8rem;
            }
            
            .report-table th,
            .report-table td {
                padding: 8px 5px;
            }
        }

        /* Estilos para sidebar */
        .sidebar {
            background: linear-gradient(180deg, var(--espam-primary) 0%, #004035 100%);
            color: var(--espam-white);
        }

        .sidebar-logo {
            max-height: 60px;
            width: auto;
        }

        .user-role {
            background-color: var(--espam-secondary);
            color: var(--espam-white);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }

        .sidebar-menu a.active {
            background-color: var(--espam-secondary);
            color: var(--espam-white);
        }

        .sidebar-menu a:hover {
            background-color: rgba(57, 181, 74, 0.2);
        }

        /* Top bar */
        .top-bar {
            background-color: var(--espam-white);
            border-bottom: 1px solid var(--espam-light-gray);
        }

        .btn-user {
            color: var(--espam-primary);
            border: 1px solid var(--espam-light-gray);
            font-family: 'Work Sans', sans-serif;
        }

        .btn-user:hover {
            background-color: var(--espam-light);
        }
    </style>
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-client.js"></script>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <img src="images/logo-espam.png" alt="Logo ESPAM MFL" class="sidebar-logo">
            <h3>UDIV ESPAM MFL</h3>
            <p class="user-role">Técnico Encargado</p>
        </div>

        <div class="user-profile">
            <div class="user-avatar">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="user-info">
                <h4>Ing. Wellington Espinoza</h4>
                <p>Laboratorio de Bromatología</p>
                <span class="user-status online"></span>
            </div>
        </div>

        <nav class="sidebar-menu">
            <ul>
                <li><a href="dashboard-tecnico.html"><i class="fas fa-tachometer-alt"></i>Dashboard</a></li>
                <li><a href="admin-laboratorios.html"><i class="fas fa-flask"></i>Gestión del Laboratorio</a></li>
                <li><a href="calendario-reservas.html"><i class="fas fa-calendar-alt"></i>Calendario</a></li>
                <li class="active"><a href="reportes.html"><i class="fas fa-chart-bar"></i>Reportes</a></li>
                <li><a href="hoja-guia.html"><i class="fas fa-file-alt"></i>Hojas Guía</a></li>
                <li><a href="perfil.html"><i class="fas fa-user-cog"></i>Configuración</a></li>
            </ul>
        </nav>
    </div>

    <div class="main-content">
        <header class="top-bar">
            <div class="top-bar-left">
                <button class="menu-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>Reportes y Estadísticas</h1>
            </div>
            <div class="top-bar-right">
                <div class="top-bar-actions">
                    <div class="user-dropdown">
                        <button class="btn-user">
                            <i class="fas fa-user-circle"></i>
                            <span>Ing. Wellington Espinoza</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu">
                            <a href="perfil.html"><i class="fas fa-user"></i> Perfil</a>
                            <a href="#"><i class="fas fa-cog"></i> Configuración</a>
                            <div class="divider"></div>
                            <a href="login.html" class="logout">
                                <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="dashboard-content">
            <!-- Header de Reportes -->
            <div class="reports-header">
                <h1><i class="fas fa-chart-line"></i> Reportes del Laboratorio de Bromatología</h1>
                <p>Genera reportes detallados sobre el uso, usuarios y equipos del laboratorio</p>
                
                <div class="reports-controls">
                    <div class="date-range">
                        <span>Período:</span>
                        <input type="date" id="startDate" value="2024-01-01">
                        <span>a</span>
                        <input type="date" id="endDate" value="2024-01-31">
                    </div>
                    
                    <button class="btn-generate" onclick="generateReports()">
                        <i class="fas fa-sync-alt"></i> Generar Reportes
                    </button>
                    
                    <button class="btn-generate" style="background-color: var(--espam-teal);">
                        <i class="fas fa-download"></i> Exportar Todo
                    </button>
                </div>
            </div>

            <!-- Filtros Avanzados -->
            <div class="filters-section">
                <h3><i class="fas fa-filter"></i> Filtros Avanzados</h3>
                <div class="filters-grid">
                    <div class="filter-group">
                        <label>Tipo de Usuario:</label>
                        <select id="filterUserType">
                            <option value="all">Todos los usuarios</option>
                            <option value="docente">Docentes</option>
                            <option value="estudiante">Estudiantes</option>
                            <option value="externo">Visitantes externos</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Carrera:</label>
                        <select id="filterCareer">
                            <option value="all">Todas las carreras</option>
                            <option value="produccion">Ing. Producción</option>
                            <option value="alimentos">Ing. Alimentos</option>
                            <option value="biotecnologia">Biotecnología</option>
                            <option value="ambiental">Ing. Ambiental</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Tipo de Actividad:</label>
                        <select id="filterActivity">
                            <option value="all">Todas las actividades</option>
                            <option value="practica">Práctica académica</option>
                            <option value="investigacion">Investigación</option>
                            <option value="tesis">Trabajo de titulación</option>
                            <option value="pasantia">Pasantías</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>Estado de Reserva:</label>
                        <select id="filterStatus">
                            <option value="all">Todos los estados</option>
                            <option value="confirmada">Confirmadas</option>
                            <option value="pendiente">Pendientes</option>
                            <option value="cancelada">Canceladas</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Grid de Reportes -->
            <div class="reports-grid">
                <!-- Reporte 1: Uso por Carrera -->
                <div class="report-card">
                    <h3>
                        <span><i class="fas fa-university"></i> Uso por Carrera</span>
                        <button class="btn-export" onclick="exportChart('carreraChart')">
                            <i class="fas fa-download"></i>
                        </button>
                    </h3>
                    <div class="chart-container">
                        <canvas id="carreraChart"></canvas>
                    </div>
                    <div class="stats-summary">
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">45%</div>
                            <div class="stat-summary-label">Ing. Producción</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">30%</div>
                            <div class="stat-summary-label">Ing. Alimentos</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">15%</div>
                            <div class="stat-summary-label">Biotecnología</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">10%</div>
                            <div class="stat-summary-label">Otras</div>
                        </div>
                    </div>
                </div>

                <!-- Reporte 2: Uso por Día de la Semana -->
                <div class="report-card">
                    <h3>
                        <span><i class="fas fa-calendar-week"></i> Uso por Día</span>
                        <button class="btn-export" onclick="exportChart('diasChart')">
                            <i class="fas fa-download"></i>
                        </button>
                    </h3>
                    <div class="chart-container">
                        <canvas id="diasChart"></canvas>
                    </div>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Día</th>
                                <th>Reservas</th>
                                <th>Horas</th>
                                <th>%</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Lunes</td>
                                <td>12</td>
                                <td>48</td>
                                <td>20%</td>
                            </tr>
                            <tr>
                                <td>Martes</td>
                                <td>15</td>
                                <td>60</td>
                                <td>25%</td>
                            </tr>
                            <tr>
                                <td>Miércoles</td>
                                <td>10</td>
                                <td>40</td>
                                <td>17%</td>
                            </tr>
                            <tr>
                                <td>Jueves</td>
                                <td>18</td>
                                <td>72</td>
                                <td>30%</td>
                            </tr>
                            <tr>
                                <td>Viernes</td>
                                <td>8</td>
                                <td>32</td>
                                <td>13%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Reporte 3: Distribución por Sexo -->
                <div class="report-card">
                    <h3>
                        <span><i class="fas fa-venus-mars"></i> Distribución por Sexo</span>
                        <button class="btn-export" onclick="exportChart('sexoChart')">
                            <i class="fas fa-download"></i>
                        </button>
                    </h3>
                    <div class="chart-container">
                        <canvas id="sexoChart"></canvas>
                    </div>
                    <div class="stats-summary">
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">55%</div>
                            <div class="stat-summary-label">Mujeres</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">42%</div>
                            <div class="stat-summary-label">Hombres</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">3%</div>
                            <div class="stat-summary-label">Otros</div>
                        </div>
                    </div>
                </div>

                <!-- Reporte 4: Usuarios con Discapacidad -->
                <div class="report-card">
                    <h3>
                        <span><i class="fas fa-wheelchair"></i> Inclusión y Accesibilidad</span>
                        <button class="btn-export" onclick="exportTable('discapacidadTable')">
                            <i class="fas fa-download"></i>
                        </button>
                    </h3>
                    <table class="report-table" id="discapacidadTable">
                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Usuarios</th>
                                <th>%</th>
                                <th>Acomodaciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Ninguna</td>
                                <td>85%</td>
                                <td>85%</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>Motora</td>
                                <td>8%</td>
                                <td>8%</td>
                                <td>Acceso rampa, mesas adaptadas</td>
                            </tr>
                            <tr>
                                <td>Visual</td>
                                <td>4%</td>
                                <td>4%</td>
                                <td>Materiales en braille, asistencia</td>
                            </tr>
                            <tr>
                                <td>Auditiva</td>
                                <td>3%</td>
                                <td>3%</td>
                                <td>Intérprete, material visual</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="export-options">
                        <button class="btn-export">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                        <button class="btn-export">
                            <i class="fas fa-file-excel"></i> Excel
                        </button>
                        <button class="btn-export">
                            <i class="fas fa-file-csv"></i> CSV
                        </button>
                    </div>
                </div>

                <!-- Reporte 5: Equipos más Utilizados -->
                <div class="report-card">
                    <h3>
                        <span><i class="fas fa-tools"></i> Equipos más Utilizados</span>
                        <button class="btn-export" onclick="exportChart('equiposChart')">
                            <i class="fas fa-download"></i>
                        </button>
                    </h3>
                    <div class="chart-container">
                        <canvas id="equiposChart"></canvas>
                    </div>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Equipo</th>
                                <th>Usos</th>
                                <th>Horas</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Microscopio</td>
                                <td>45</td>
                                <td>180</td>
                                <td><span class="status-optimo">Óptimo</span></td>
                            </tr>
                            <tr>
                                <td>Balanza Analítica</td>
                                <td>38</td>
                                <td>152</td>
                                <td><span class="status-optimo">Óptimo</span></td>
                            </tr>
                            <tr>
                                <td>Centrífuga</td>
                                <td>32</td>
                                <td>128</td>
                                <td><span class="status-mantenimiento">Mantenimiento</span></td>
                            </tr>
                            <tr>
                                <td>Estufa Incubación</td>
                                <td>28</td>
                                <td>112</td>
                                <td><span class="status-regular">Regular</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Reporte 6: Calificaciones de Usuarios -->
                <div class="report-card">
                    <h3>
                        <span><i class="fas fa-star"></i> Satisfacción de Usuarios</span>
                        <button class="btn-export" onclick="exportChart('ratingChart')">
                            <i class="fas fa-download"></i>
                        </button>
                    </h3>
                    <div class="chart-container">
                        <canvas id="ratingChart"></canvas>
                    </div>
                    <div class="stats-summary">
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">4.5</div>
                            <div class="stat-summary-label">Laboratorio</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">4.8</div>
                            <div class="stat-summary-label">Técnico</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">4.3</div>
                            <div class="stat-summary-label">Equipos</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">4.6</div>
                            <div class="stat-summary-label">Limpieza</div>
                        </div>
                    </div>
                </div>

                <!-- Reporte 7: Pasantías de Colegios -->
                <div class="report-card">
                    <h3>
                        <span><i class="fas fa-school"></i> Pasantías de Colegios</span>
                        <button class="btn-export" onclick="exportTable('pasantiasTable')">
                            <i class="fas fa-download"></i>
                        </button>
                    </h3>
                    <table class="report-table" id="pasantiasTable">
                        <thead>
                            <tr>
                                <th>Colegio</th>
                                <th>Estudiantes</th>
                                <th>Fechas</th>
                                <th>Área</th>
                                <th>Discapacidad</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Colegio Manabí</td>
                                <td>15</td>
                                <td>Ene 10-12</td>
                                <td>Biología</td>
                                <td>1 visual</td>
                            </tr>
                            <tr>
                                <td>Unidad Educativa Calceta</td>
                                <td>12</td>
                                <td>Ene 15-17</td>
                                <td>Química</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>Colegio Técnico Rocafuerte</td>
                                <td>20</td>
                                <td>Ene 22-24</td>
                                <td>Producción</td>
                                <td>2 motoras</td>
                            </tr>
                            <tr>
                                <td>Instituto Superior Portoviejo</td>
                                <td>18</td>
                                <td>Feb 5-7</td>
                                <td>Alimentos</td>
                                <td>-</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="export-options">
                        <button class="btn-export">
                            <i class="fas fa-print"></i> Imprimir
                        </button>
                        <button class="btn-export">
                            <i class="fas fa-envelope"></i> Enviar
                        </button>
                    </div>
                </div>

                <!-- Reporte 8: Reporte Unificado -->
                <div class="report-card" style="grid-column: span 2;">
                    <h3>
                        <span><i class="fas fa-file-contract"></i> Reporte Unificado Mensual</span>
                        <div class="export-options">
                            <button class="btn-export">
                                <i class="fas fa-file-pdf"></i> PDF Completo
                            </button>
                            <button class="btn-export">
                                <i class="fas fa-file-word"></i> Word
                            </button>
                        </div>
                    </h3>
                    <div class="stats-summary">
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">142</div>
                            <div class="stat-summary-label">Total Reservas</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">568</div>
                            <div class="stat-summary-label">Horas de Uso</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">45</div>
                            <div class="stat-summary-label">Usuarios Únicos</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">98%</div>
                            <div class="stat-summary-label">Tasa de Ocupación</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">3</div>
                            <div class="stat-summary-label">Mantenimientos</div>
                        </div>
                        <div class="stat-summary-item">
                            <div class="stat-summary-value">4.6/5</div>
                            <div class="stat-summary-label">Satisfacción</div>
                        </div>
                    </div>
                    
                    <h4 style="margin-top: 25px; color: var(--espam-primary);">
                        <i class="fas fa-chart-pie"></i> Resumen por Variables
                    </h4>
                    
                    <div class="grid-2-columns">
                        <div>
                            <h5>Por Carrera:</h5>
                            <ul>
                                <li>Ing. Producción: 45% (64 reservas)</li>
                                <li>Ing. Alimentos: 30% (43 reservas)</li>
                                <li>Biotecnología: 15% (21 reservas)</li>
                                <li>Otras: 10% (14 reservas)</li>
                            </ul>
                        </div>
                        <div>
                            <h5>Por Sexo:</h5>
                            <ul>
                                <li>Mujeres: 55% (25 usuarios)</li>
                                <li>Hombres: 42% (19 usuarios)</li>
                                <li>Otros: 3% (1 usuario)</li>
                            </ul>
                        </div>
                        <div>
                            <h5>Por Tipo de Actividad:</h5>
                            <ul>
                                <li>Prácticas académicas: 70%</li>
                                <li>Investigación: 20%</li>
                                <li>Pasantías: 8%</li>
                                <li>Otros: 2%</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="recomendaciones">
                        <h5><i class="fas fa-lightbulb"></i> Recomendaciones:</h5>
                        <p>1. Incrementar frecuencia de mantenimiento de la centrífuga<br>
                        2. Considerar ampliación de horarios los jueves (30% de uso)<br>
                        3. Adquirir más equipos de microscopía (45 usos/mes)<br>
                        4. Implementar más adaptaciones para discapacidad motora</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts de gráficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script>
        // Colores de gráficos ajustados a paleta ESPAM
        const espamColors = {
            primary: '#005846',
            secondary: '#39b54a',
            accent: '#cbdb2a',
            teal: '#08b89d',
            light: '#F8F8F2',
            colors: ['#005846', '#39b54a', '#cbdb2a', '#08b89d', '#F8F8F2']
        };

        // Inicializar gráficos cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            loadReportData();
        });

        function initializeCharts() {
            // Gráfico 1: Uso por Carrera (Doughnut)
            const ctxCarrera = document.getElementById('carreraChart').getContext('2d');
            new Chart(ctxCarrera, {
                type: 'doughnut',
                data: {
                    labels: ['Ing. Producción', 'Ing. Alimentos', 'Biotecnología', 'Otras'],
                    datasets: [{
                        data: [45, 30, 15, 10],
                        backgroundColor: [
                            espamColors.primary,
                            espamColors.secondary,
                            espamColors.accent,
                            espamColors.teal
                        ],
                        borderWidth: 2,
                        borderColor: espamColors.light
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            }
                        }
                    }
                }
            });

            // Gráfico 2: Uso por Día (Bar)
            const ctxDias = document.getElementById('diasChart').getContext('2d');
            new Chart(ctxDias, {
                type: 'bar',
                data: {
                    labels: ['Lun', 'Mar', 'Mié', 'Jue', 'Vie'],
                    datasets: [{
                        label: 'Reservas',
                        data: [12, 15, 10, 18, 8],
                        backgroundColor: espamColors.secondary,
                        borderColor: espamColors.primary,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 5,
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            }
                        }
                    }
                }
            });

            // Gráfico 3: Distribución por Sexo (Pie)
            const ctxSexo = document.getElementById('sexoChart').getContext('2d');
            new Chart(ctxSexo, {
                type: 'pie',
                data: {
                    labels: ['Mujeres', 'Hombres', 'Otros'],
                    datasets: [{
                        data: [55, 42, 3],
                        backgroundColor: [
                            espamColors.primary,
                            espamColors.secondary,
                            espamColors.accent
                        ],
                        borderWidth: 2,
                        borderColor: espamColors.light
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            }
                        }
                    }
                }
            });

            // Gráfico 4: Equipos más Utilizados (Horizontal Bar)
            const ctxEquipos = document.getElementById('equiposChart').getContext('2d');
            new Chart(ctxEquipos, {
                type: 'bar',
                data: {
                    labels: ['Microscopio', 'Balanza', 'Centrífuga', 'Estufa', 'pH-metro'],
                    datasets: [{
                        label: 'Número de Usos',
                        data: [45, 38, 32, 28, 22],
                        backgroundColor: espamColors.teal,
                        borderColor: espamColors.primary,
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            }
                        }
                    }
                }
            });

            // Gráfico 5: Calificaciones (Radar)
            const ctxRating = document.getElementById('ratingChart').getContext('2d');
            new Chart(ctxRating, {
                type: 'radar',
                data: {
                    labels: ['Laboratorio', 'Técnico', 'Equipos', 'Limpieza', 'Organización', 'Seguridad'],
                    datasets: [{
                        label: 'Calificación Promedio',
                        data: [4.5, 4.8, 4.3, 4.6, 4.4, 4.7],
                        backgroundColor: 'rgba(57, 181, 74, 0.2)',
                        borderColor: espamColors.secondary,
                        borderWidth: 2,
                        pointBackgroundColor: espamColors.secondary,
                        pointBorderColor: espamColors.light,
                        pointBorderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 5,
                            ticks: {
                                stepSize: 1,
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            angleLines: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    family: 'Work Sans, sans-serif'
                                }
                            }
                        }
                    }
                }
            });
        }

        function loadReportData() {
            // Cargar datos iniciales para reportes
            console.log('Cargando datos de reportes ESPAM MFL...');
            
            // Aquí iría la lógica para cargar datos reales desde una API
            // Por ahora usamos datos estáticos
        }

        function generateReports() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const userType = document.getElementById('filterUserType').value;
            const career = document.getElementById('filterCareer').value;
            
            // Mostrar mensaje con colores ESPAM
            const message = `Generando reportes ESPAM MFL para:\nPeríodo: ${startDate} - ${endDate}\nTipo de usuario: ${userType}\nCarrera: ${career}`;
            
            // Notificación personalizada
            showNotification('Reportes generados', 'Los reportes han sido actualizados con los filtros seleccionados.', 'success');
            
            // Aquí iría la lógica para regenerar reportes con nuevos filtros
        }

        function exportChart(chartId) {
            const chartCanvas = document.getElementById(chartId);
            if (chartCanvas) {
                const link = document.createElement('a');
                link.download = `ESPAM_${chartId}_${new Date().toISOString().split('T')[0]}.png`;
                link.href = chartCanvas.toDataURL('image/png');
                link.click();
                showNotification('Exportación exitosa', `Gráfico ${chartId} exportado como imagen PNG`, 'success');
            }
        }

        function exportTable(tableId) {
            const table = document.getElementById(tableId);
            if (table) {
                // Convertir tabla a CSV
                let csv = [];
                const rows = table.querySelectorAll('tr');
                
                for (let i = 0; i < rows.length; i++) {
                    const row = [], cols = rows[i].querySelectorAll('td, th');
                    
                    for (let j = 0; j < cols.length; j++) {
                        row.push(cols[j].innerText);
                    }
                    
                    csv.push(row.join(','));
                }
                
                // Descargar CSV
                const csvContent = csv.join('\n');
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', `ESPAM_${tableId}_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                showNotification('Exportación exitosa', `Tabla ${tableId} exportada como CSV`, 'success');
            }
        }

        // Función para mostrar notificaciones
        function showNotification(title, message, type = 'info') {
            // Crear elemento de notificación
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 5px;
                background-color: ${type === 'success' ? espamColors.secondary : espamColors.teal};
                color: white;
                font-family: 'Work Sans', sans-serif;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                max-width: 300px;
                animation: slideIn 0.3s ease;
            `;
            
            notification.innerHTML = `
                <strong>${title}</strong>
                <p style="margin: 5px 0 0 0; font-size: 0.9rem;">${message}</p>
            `;
            
            document.body.appendChild(notification);
            
            // Remover después de 3 segundos
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Añadir animaciones CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOut {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>